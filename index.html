<!doctype html>
<html>
	<head>
		<title>Arc Clock</title>
		<script type="module">
			class ArcClock extends HTMLElement {
				connectedCallback() {
					let totalHours = Number(this.getAttribute("total-hours"));

					if (!totalHours || Number.isNaN(totalHours)) {
						totalHours = 24;
					}

					let date = new Date();
					let seconds = date.getSeconds();
					let minutes = date.getMinutes() * 60 + seconds;
					let hours = (date.getHours() % totalHours) * 3_600 + minutes;
					let div = document.createElement("div");

					div.style.setProperty(`--hours-duration`, `${totalHours * 3_600}s`);
					div.style.setProperty(`--hours-delay`, `${-1 * hours}s`);
					div.style.setProperty(`--minutes-delay`, `${-1 * minutes}s`);
					div.style.setProperty(`--seconds-delay`, `${-1 * seconds}s`);

					this.append(div);
				}
			}

			customElements.define("arc-clock", ArcClock);
		</script>
		<style>
			@property --time {
				syntax: "<percentage>";
				inherits: true;
				initial-value: 0%;
			}

			@keyframes cycle {
				0% {
					--time: 0%;
				}

				100% {
					--time: 100%;
				}
			}

			arc-clock {
				:where(div) {
					grid-template-columns: var(--template);
					grid-template-rows: var(--template);
					gap: var(--gap);
					--color: var(--hours-color);
					--template: repeat(3, var(--size)) auto repeat(3, var(--size));
					--duration: var(--hours-duration);
					--delay: var(--hours-delay);

					&,
					&::before,
					&::after {
						will-change: var(--time);
						border-radius: 100%;
						display: grid;
						aspect-ratio: 1;
						background: radial-gradient(
								closest-side,
								white,
								white calc(100% - var(--size)),
								oklab(0% 0 0 / 0) calc(100% - var(--size)),
								oklab(0% 0 0 / 0)
							),
							conic-gradient(
								var(--color),
								var(--color) var(--time),
								white var(--time)
							);
						animation-timing-function: linear;
						animation-name: cycle;
						animation-duration: var(--duration);
						animation-delay: var(--delay);
						animation-iteration-count: infinite;
					}

					&::before,
					&::after {
						content: "";
						grid-column: var(--col-row);
						grid-row: var(--col-row);
					}

					&::before {
						--color: var(--minutes-color);
						--col-row: 2 / -2;
						--duration: 3600s;
						--delay: var(--minutes-delay);
					}

					&::after {
						--color: var(--seconds-color);
						--col-row: 3 / -3;
						--duration: 60s;
						--delay: var(--seconds-delay);
					}
				}
			}

			@layer user {
				* {
					box-sizing: border-box;
					margin: 0;
					padding: 0;
				}

				html,
				body {
					block-size: 100%;
				}

				body {
					display: grid;
					place-content: center;
				}

				arc-clock {
					inline-size: 30rem;
					aspect-ratio: 1;
					--size: 2rem;
					--gap: 0.25rem;
					--hours-color: oklab(90% 0.3 0.2);
					--minutes-color: oklab(90% -0.1 0.4);
					--seconds-color: oklab(90% -0.1 -0.4);
				}
			}
		</style>
	</head>
	<body>
		<arc-clock total-hours="12"></arc-clock>
	</body>
</html>
